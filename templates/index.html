<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BKDict - Vocabulary Learning App</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <!-- Main Container -->
    <div class="container">

        <!-- Header Section -->
        <header class="app-header">
            <h1 class="app-title">üìö Easy Vocab</h1>
            <button id="themeToggle" class="theme-toggle" title="Toggle dark mode">
                <span class="icon sun-icon">‚òÄÔ∏è</span>
                <span class="icon moon-icon">üåô</span>
            </button>
        </header>

        <!-- Control Panel -->
        <div class="control-panel">

            <!-- Row 1: Action Buttons -->
            <div class="control-row action-controls">
                <button id="importBtn" class="btn btn-import">üì• Import XML</button>
                <button id="addWordBtn" class="btn btn-add-word">‚ú® Add New Word</button>
                <a href="/quiz" class="btn btn-quiz">üéØ Quiz Me</a>
                <div id="importPanel" class="import-panel" style="display: none;">
                    <input type="file" id="fileInput" accept=".xml" class="file-input">
                    <button id="uploadBtn" class="btn btn-primary">Upload</button>
                    <button id="cancelUploadBtn" class="btn btn-cancel">Cancel</button>
                    <div id="uploadStatus" class="upload-status"></div>
                </div>
            </div>


        </div>

        <!-- Add Word Modal -->
        <div id="addWordModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Add New Word</h2>
                    <button id="closeModalBtn" class="btn-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="newWord">Word (English) *</label>
                        <input type="text" id="newWord" class="form-input" placeholder="Enter word..." required>
                    </div>
                    <div class="form-group">
                        <div class="form-label-row">
                            <label for="newTranslation">Translation (Chinese) *</label>
                            <button id="generateNewTransBtn" class="btn btn-generate btn-sm" type="button">‚ú®
                                Generate</button>
                        </div>
                        <input type="text" id="newTranslation" class="form-input" placeholder="Enter translation..."
                            required>
                    </div>
                    <div class="form-group">
                        <label for="newCategory">Category *</label>
                        <select id="newCategory" class="form-input" required>
                            <option value="">-- Select Category --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <div class="form-label-row">
                            <label for="newSample">Example Sentences (optional)</label>
                            <button id="generateNewSampleBtn" class="btn btn-generate btn-sm" type="button">‚ú® Generate
                            </button>
                        </div>
                        <textarea id="newSample" class="form-textarea"
                            placeholder="Enter sample sentences (one per line)..." rows="4"></textarea>
                        <small class="form-hint">Enter one sentence per line</small>
                    </div>
                    <div id="addWordStatus" class="form-status"></div>
                </div>
                <div class="modal-footer">
                    <button id="submitWordBtn" class="btn btn-primary">Add Word</button>
                    <button id="cancelModalBtn" class="btn btn-cancel">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Search Results Panel -->
        <!-- Search Results Panel -->
        <div id="searchResults" class="search-results-panel" style="display: none;">
            <div class="search-results-header">
                <h3>Search Results</h3>
                <div class="search-header-controls">
                    <span id="searchResultsCount" class="search-count"></span>
                    <button id="closeSearchResultsBtn" class="btn-close-results" title="Close results">&times;</button>
                </div>
            </div>
            <div id="searchResultsList" class="search-results-list">
                <!-- Results will be populated here -->
            </div>
        </div>

        <!-- Word Display Card -->
        <div id="wordCard" class="word-card" style="display: none;">

            <!-- Primary Controls (Category/Sort/Search) -->
            <div class="control-row primary-controls">
                <!-- Category Selection -->
                <div class="control-group">
                    <label for="categorySelect" class="control-label">Category:</label>
                    <select id="categorySelect" class="category-select">
                        <option value="">-- Loading categories... --</option>
                    </select>
                    <span id="categoryInfo" class="category-info"></span>
                </div>

                <!-- Sort Toggle -->
                <div class="control-group sort-group">
                    <label for="sortSelect" class="control-label">Sort:</label>
                    <select id="sortSelect" class="sort-select">
                        <option value="updated_at">Recent Edits (Latest First)</option>
                        <option value="updated_at_asc">Oldest Edits (Oldest First)</option>
                        <option value="review_count">Most Reviewed</option>
                    </select>
                </div>

                <!-- Search Section -->
                <div class="control-group search-group">
                    <label for="searchInput" class="control-label">Search:</label>
                    <div class="search-container">
                        <input type="text" id="searchInput" class="search-input" placeholder="Enter word or phrase...">
                        <button id="searchBtn" class="btn btn-primary btn-sm">Search</button>
                        <button id="clearSearchBtn" class="btn btn-cancel btn-sm" style="display: none;">Clear</button>
                    </div>
                </div>
            </div>

            <!-- Word Section -->
            <div class="word-section">
                <!-- Status Bar (Top Left) -->
                <div class="status-bar">

                    <span id="dailyCounter" class="status-badge daily-badge">0</span>
                    <div class="debt-wrapper">
                        <button id="wordDebtBtn" class="status-badge debt-badge">Word Debt: 0</button>
                        <div id="wordDebtDropdown" class="debt-dropdown">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Word Display/Edit -->
                <div class="word-content">
                    <div id="wordDisplayContainer">
                        <h2 id="wordDisplay" class="word-display">Loading...</h2>
                        <button id="editWordBtn" class="btn btn-edit-word" title="Edit word">‚úèÔ∏è</button>
                        <!-- Review Counter Badge -->
                        <div id="reviewCounter" class="review-counter-badge" title="Click to mark as reviewed">
                            <span id="reviewCount">0</span>
                        </div>
                    </div>
                    <div id="wordEdit" class="word-edit" style="display: none;">
                        <input type="text" id="wordInput" class="word-input" placeholder="Edit word..." />
                        <div class="edit-actions-inline">
                            <button id="saveWordBtn" class="btn btn-save btn-sm">Save</button>
                            <button id="cancelWordBtn" class="btn btn-cancel btn-sm">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Modification History Dropdown (bottom left) -->
                <div class="history-dropdown-container">
                    <label for="historySelect" class="history-label">History:</label>
                    <select id="historySelect" class="history-select">
                        <option value="">Latest</option>
                    </select>
                </div>
            </div>

            <!-- Word Actions Section -->
            <div class="word-actions">
                <div class="action-group">
                    <label for="changeCategorySelect" class="action-label">Move to Category:</label>
                    <select id="changeCategorySelect" class="category-change-select">
                        <option value="">-- Select Category --</option>
                    </select>
                    <button id="moveCategoryBtn" class="btn btn-secondary btn-sm">Move</button>
                    <button id="deleteWordBtn" class="btn btn-secondary btn-sm btn-delete-inline">üóëÔ∏è Delete</button>
                </div>
            </div>

            <!-- Translation Section -->
            <div class="translation-section">
                <div class="section-header">
                    <h3 class="section-title">Translation:</h3>
                    <div class="generate-controls">
                        <select id="transModelSelect" class="model-select">
                            <option value="Claude-Haiku-4.5">Haiku-4.5</option>
                            <option value="gemini-3-flash">Gemini-3-Flash</option>
                            <option value="gpt-4o">GPT-4o</option>
                        </select>
                        <button id="generateTransBtn" class="btn btn-generate">‚ú® Generate</button>
                    </div>
                </div>
                <div id="translationDisplay" class="content-display editable-field" title="Click to edit"></div>
                <div id="translationEdit" class="content-edit" style="display: none;">
                    <textarea id="translationInput" class="content-textarea" rows="4"></textarea>
                    <div class="edit-actions">
                        <button id="saveTransBtn" class="btn btn-save">Save</button>
                        <button id="cancelTransBtn" class="btn btn-cancel">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Example Sentence Section (Multiple Sentences Supported) -->
            <div class="example-section">
                <div class="section-header">
                    <h3 class="section-title">Example Sentences:</h3>
                    <div class="generate-controls">
                        <select id="modelSelect" class="model-select">
                            <option value="Claude-Haiku-4.5">Haiku-4.5</option>
                            <option value="gemini-3-flash">Gemini-3-Flash</option>
                            <option value="gpt-4o">GPT-4o</option>
                        </select>
                        <button id="generateSampleBtn" class="btn btn-generate">‚ú® Generate</button>
                    </div>
                </div>
                <div id="sampleDisplay" class="content-display empty editable-field" title="Click to edit">
                    <p class="empty-hint">No example sentences yet. Click here to add some.</p>
                </div>
                <div id="sampleEdit" class="content-edit" style="display: none;">
                    <p class="edit-hint">Type each sentence on a new line:</p>
                    <textarea id="sampleInput" class="content-textarea" rows="6"
                        placeholder="Enter example sentences (one per line)..."></textarea>
                    <div class="edit-actions">
                        <button id="saveSampleBtn" class="btn btn-save">Save</button>
                        <button id="cancelSampleBtn" class="btn btn-cancel">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="navigation-buttons">
                <button id="prevBtn" class="btn btn-nav">‚Üê Previous</button>
                <button id="nextBtn" class="btn btn-nav">Next ‚Üí</button>
            </div>

        </div>

        <!-- Welcome Message (shown when no category selected) -->
        <div id="welcomeMessage" class="welcome-message">
            <div class="welcome-icon" id="bookIcon" style="cursor: pointer; margin-top: -30px;"
                onclick="loadFirstCategory()">üìñ</div>
            <h2 style="margin-top: -30px;">Welcome to Easy Vocab</h2>
            <p
                style="font-size: 1rem; color: var(--text-secondary); margin-top: calc(-0.5rem - 10px); margin-bottom: 1.5rem;">
                Your Vocabulary Learning Companion</p>
            <button onclick="loadFirstCategory()" class="btn btn-primary"
                style="font-size: 1.5rem; padding: 1rem 2.5rem; border-radius: 12px;">
                Enter
            </button>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loadingIndicator" class="loading-indicator" style="display: none;">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <!-- Error Message -->
    <div id="errorMessage" class="error-message" style="display: none;">
        <span class="error-icon">‚ö†Ô∏è</span>
        <span id="errorText"></span>
    </div>

    </div>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>

</html>